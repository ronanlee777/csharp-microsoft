<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. See LICENSE in the project root for license information. -->
<Project ToolsVersion="15.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003" Sdk="Microsoft.NET.Sdk">
  <Import Project="$(MSBuildProjectDirectory)\..\MUXControlsReleaseTest.props" Condition="Exists('$(MSBuildProjectDirectory)\..\MUXControlsReleaseTest.props') And $(BuildingWithBuildExe) != 'true'" />
  <Import Project="$(MSBuildProjectDirectory)\..\ReleaseTestSdkVersion.props" Condition="Exists('$(MSBuildProjectDirectory)\..\ReleaseTestSdkVersion.props') And $(BuildingWithBuildExe) != 'true'" />
  <Import Condition="'$(PGOBuildMode)' == 'Instrument'" Project="$(MSBuildProjectDirectory)\..\..\..\..\PGO.runtime.props" />
  
  <PropertyGroup>
    <TargetFramework>net5.0-windows$(MuxSdkVersion)</TargetFramework>
    <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
    <Platforms>x86;x64;arm;arm64</Platforms>
    <RuntimeIdentifiers>win-x86;win-x64;win-arm;win-arm64</RuntimeIdentifiers>
    <!-- Some platforms like ARM can be passed in as Platform="ARM" (upper case), which VS doesn't like in the case of RuntimeIdentifier.
         We'll explicitly set RuntimeIdentifier values instead of passing in $(Platform) to avoid this. -->
    <RuntimeIdentifier Condition="'$(Platform)' == 'x86' or '$(Platform)' == 'Win32'">win-x86</RuntimeIdentifier>
    <RuntimeIdentifier Condition="'$(Platform)' == 'x64'">win-x64</RuntimeIdentifier>
    <RuntimeIdentifier Condition="'$(Platform)' == 'arm'">win-arm</RuntimeIdentifier>
    <RuntimeIdentifier Condition="'$(Platform)' == 'arm64'">win-arm64</RuntimeIdentifier>
    <SelfContained>true</SelfContained>
    <PublishSingleFile>False</PublishSingleFile>
    <PublishReadyToRun>True</PublishReadyToRun>
    
    <!-- The binaries we're building against are managed, so which platform's folder they come out of is immaterial.
         For simplicity's sake, we'll always get them from the x86 folder, but the CoreClr binaries are the same everywhere. -->
    <TaefRootDirectory>$(NuGetPackageRoot)microsoft.taef\10.65.211117001\build\Binaries\x86\netstandard2.0\</TaefRootDirectory>
    <ProjectGuid>{14018522-0223-4334-87D2-C343074DDD48}</ProjectGuid>
  </PropertyGroup>
  <ItemGroup Condition="$(BuildingWithBuildExe) != 'true'">
    <Reference Include="TE.Managed">
      <HintPath>$(TaefRootDirectory)TE.Managed.dll</HintPath>
    </Reference>
    <Reference Include="TE.ManagedTestMode">
      <HintPath>$(TaefRootDirectory)TE.ManagedTestMode.dll</HintPath>
    </Reference>
    <Reference Include="Wex.Common.Managed">
      <HintPath>$(TaefRootDirectory)Wex.Common.Managed.dll</HintPath>
    </Reference>
    <Reference Include="Wex.Logger.Interop">
      <HintPath>$(TaefRootDirectory)Wex.Logger.Interop.dll</HintPath>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <PackageReference Include="Microsoft.Win32.Registry" Version="4.7.0" />
    <PackageReference Include="Microsoft.Windows.Apps.Test" Version="1.0.181205002" />
    <PackageReference Include="Microsoft.Taef" Version="10.65.211117001" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\..\MUXControls.Test\MUXControls.Test.csproj" />
  </ItemGroup>
  <PropertyGroup>
    <MSBuildAllProjects>$(MSBuildAllProjects);$(MSBuildThisFileFullPath)</MSBuildAllProjects>
    <HasSharedItems>true</HasSharedItems>
    <SharedGUID>c86d3f1a-cd11-406d-abee-ae4c9f23b8fe</SharedGUID>
    <DefineConstants Condition="'$(Configuration)' == 'Release' and '$(PGOBuildMode)' == 'Instrument'">$(DefineConstants);PGO_INSTRUMENT</DefineConstants>
  </PropertyGroup>
  <PropertyGroup Label="Configuration">
    <Import_RootNamespace>MUXControls.ReleaseTest</Import_RootNamespace>
  </PropertyGroup>
  <PropertyGroup>
    <AssemblyName>MUXControls.ReleaseTest</AssemblyName>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{0133B2CB-960C-4BA5-ABFA-570F18CDB47A}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>MUXControls.ReleaseTest</RootNamespace>
    <TargetPlatformVersion Condition="'$(TargetPlatformVersion)' == ''">$(MuxSdkVersion)</TargetPlatformVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{A5A43C5B-DE2A-4C0C-9213-0A381AF9435A};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
    <LangVersion>$(CSLangVersion)</LangVersion>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Debug|x86'">
    <PlatformTarget>x86</PlatformTarget>
    <DebugSymbols>true</DebugSymbols>
    <DefineConstants>$(DefineConstants);DEBUG;TRACE;NETFX_CORE;WINDOWS_UWP</DefineConstants>
    <NoWarn>;2008</NoWarn>
    <DebugType>full</DebugType>
    <UseVSHostingProcess>false</UseVSHostingProcess>
    <ErrorReport>prompt</ErrorReport>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Release|x86'">
    <PlatformTarget>x86</PlatformTarget>
    <DefineConstants>$(DefineConstants);TRACE;NETFX_CORE;WINDOWS_UWP</DefineConstants>
    <Optimize>true</Optimize>
    <NoWarn>;2008</NoWarn>
    <DebugType>pdbonly</DebugType>
    <UseVSHostingProcess>false</UseVSHostingProcess>
    <ErrorReport>prompt</ErrorReport>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Debug|ARM'">
    <PlatformTarget>ARM</PlatformTarget>
    <DebugSymbols>true</DebugSymbols>
    <DefineConstants>$(DefineConstants);DEBUG;TRACE;NETFX_CORE;WINDOWS_UWP</DefineConstants>
    <NoWarn>;2008</NoWarn>
    <DebugType>full</DebugType>
    <UseVSHostingProcess>false</UseVSHostingProcess>
    <ErrorReport>prompt</ErrorReport>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Release|ARM'">
    <PlatformTarget>ARM</PlatformTarget>
    <DefineConstants>$(DefineConstants);TRACE;NETFX_CORE;WINDOWS_UWP</DefineConstants>
    <Optimize>true</Optimize>
    <NoWarn>;2008</NoWarn>
    <DebugType>pdbonly</DebugType>
    <UseVSHostingProcess>false</UseVSHostingProcess>
    <ErrorReport>prompt</ErrorReport>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Debug|x64'">
    <PlatformTarget>x64</PlatformTarget>
    <DebugSymbols>true</DebugSymbols>
    <DefineConstants>$(DefineConstants);DEBUG;TRACE;NETFX_CORE;WINDOWS_UWP</DefineConstants>
    <NoWarn>;2008</NoWarn>
    <DebugType>full</DebugType>
    <UseVSHostingProcess>false</UseVSHostingProcess>
    <ErrorReport>prompt</ErrorReport>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Release|x64'">
    <PlatformTarget>x64</PlatformTarget>
    <DefineConstants>$(DefineConstants);TRACE;NETFX_CORE;WINDOWS_UWP</DefineConstants>
    <Optimize>true</Optimize>
    <NoWarn>;2008</NoWarn>
    <DebugType>pdbonly</DebugType>
    <UseVSHostingProcess>false</UseVSHostingProcess>
    <ErrorReport>prompt</ErrorReport>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Debug|ARM64'">
    <PlatformTarget>ARM</PlatformTarget>
    <DebugSymbols>true</DebugSymbols>
    <DefineConstants>$(DefineConstants);DEBUG;TRACE;NETFX_CORE;WINDOWS_UWP</DefineConstants>
    <NoWarn>;2008</NoWarn>
    <DebugType>full</DebugType>
    <UseVSHostingProcess>false</UseVSHostingProcess>
    <ErrorReport>prompt</ErrorReport>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Release|ARM64'">
    <PlatformTarget>ARM</PlatformTarget>
    <DefineConstants>$(DefineConstants);TRACE;NETFX_CORE;WINDOWS_UWP</DefineConstants>
    <Optimize>true</Optimize>
    <NoWarn>;2008</NoWarn>
    <DebugType>pdbonly</DebugType>
    <UseVSHostingProcess>false</UseVSHostingProcess>
    <ErrorReport>prompt</ErrorReport>
  </PropertyGroup>
  <PropertyGroup>
    <RestoreProjectStyle>PackageReference</RestoreProjectStyle>
  </PropertyGroup>
  <ItemGroup>
    <Compile Include="$(MSBuildThisFileDirectory)AppThatUsesMUXIndirectlyTests.cs" />
    <Compile Include="$(MSBuildThisFileDirectory)PGOManager.cs" />
    <Compile Include="$(MSBuildThisFileDirectory)NugetTestsCX.cs" />
    <Compile Include="$(MSBuildThisFileDirectory)NugetTests.cs" />
    <Compile Include="$(MSBuildThisFileDirectory)ReleaseTestEnvironment.cs" />
    <Compile Include="$(MSBuildThisFileDirectory)XamlIslandsTests.cs" />
    <Compile Include="$(MSBuildThisFileDirectory)XamlIslandsTestsBase.cs" />
    <Compile Include="$(MSBuildThisFileDirectory)XamlIslandsUnpackagedTests.cs" />
    <EmbeddedResource Include="$(MSBuildThisFileDirectory)Properties\MuxControls.ReleaseTest.rd.xml">
      <SubType>Designer</SubType>
    </EmbeddedResource>
  </ItemGroup>
  <PropertyGroup Condition=" '$(VisualStudioVersion)' == '' or '$(VisualStudioVersion)' &lt; '15.0' ">
    <VisualStudioVersion>15.0</VisualStudioVersion>
  </PropertyGroup>
</Project>